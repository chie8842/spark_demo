{"paragraphs":[{"text":"%md\n1. Title: Boston Housing Data\n\n2. Sources:\n   (a) Origin:  This dataset was taken from the StatLib library which is\n                maintained at Carnegie Mellon University.\n   (b) Creator:  Harrison, D. and Rubinfeld, D.L. 'Hedonic prices and the \n                 demand for clean air', J. Environ. Economics & Management,\n                 vol.5, 81-102, 1978.\n   (c) Date: July 7, 1993\n\n3. Past Usage:\n   -   Used in Belsley, Kuh & Welsch, 'Regression diagnostics ...', Wiley, \n       1980.   N.B. Various transformations are used in the table on\n       pages 244-261.\n    -  Quinlan,R. (1993). Combining Instance-Based and Model-Based Learning.\n       In Proceedings on the Tenth International Conference of Machine \n       Learning, 236-243, University of Massachusetts, Amherst. Morgan\n       Kaufmann.\n\n4. Relevant Information:\n\n   Concerns housing values in suburbs of Boston.\n\n5. Number of Instances: 506\n\n6. Number of Attributes: 13 continuous attributes (including \"class\"\n                         attribute \"MEDV\"), 1 binary-valued attribute.\n\n7. Attribute Information:\n\n    1. CRIM      per capita crime rate by town\n    2. ZN        proportion of residential land zoned for lots over \n                 25,000 sq.ft.\n    3. INDUS     proportion of non-retail business acres per town\n    4. CHAS      Charles River dummy variable (= 1 if tract bounds \n                 river; 0 otherwise)\n    5. NOX       nitric oxides concentration (parts per 10 million)\n    6. RM        average number of rooms per dwelling\n    7. AGE       proportion of owner-occupied units built prior to 1940\n    8. DIS       weighted distances to five Boston employment centres\n    9. RAD       index of accessibility to radial highways\n    10. TAX      full-value property-tax rate per $10,000\n    11. PTRATIO  pupil-teacher ratio by town\n    12. B        1000(Bk - 0.63)^2 where Bk is the proportion of blacks \n                 by town\n    13. LSTAT    % lower status of the population\n    14. MEDV     Median value of owner-occupied homes in $1000's\n\n8. Missing Attribute Values:  None.","user":"anonymous","dateUpdated":"2017-10-11T07:16:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<ol>\n<li><p>Title: Boston Housing Data</p>\n</li>\n<li><p>Sources:\n<br  />(a) Origin:  This dataset was taken from the StatLib library which is</p>\n<pre><code>        maintained at Carnegie Mellon University.\n</code></pre>\n<p>(b) Creator:  Harrison, D. and Rubinfeld, D.L. 'Hedonic prices and the</p>\n<pre><code>         demand for clean air', J. Environ. Economics &amp; Management,\n         vol.5, 81-102, 1978.\n</code></pre>\n<p>(c) Date: July 7, 1993</p>\n</li>\n<li><p>Past Usage:</p>\n</li>\n<li><p>Used in Belsley, Kuh &amp; Welsch, 'Regression diagnostics &hellip;', Wiley,</p>\n<ol>\n<li>N.B. Various transformations are used in the table on\n<br  />pages 244-261.</li>\n<li>Quinlan,R. (1993). Combining Instance-Based and Model-Based Learning.\n<br  />In Proceedings on the Tenth International Conference of Machine\n<br  />Learning, 236-243, University of Massachusetts, Amherst. Morgan\n<br  />Kaufmann.</li>\n</ol>\n</li>\n<li><p>Relevant Information:</p>\n<p>Concerns housing values in suburbs of Boston.</p>\n</li>\n<li><p>Number of Instances: 506</p>\n</li>\n<li><p>Number of Attributes: 13 continuous attributes (including &ldquo;class&rdquo;</p>\n<pre><code>                 attribute \"MEDV\"), 1 binary-valued attribute.\n</code></pre>\n</li>\n<li><p>Attribute Information:</p>\n<ol>\n<li>CRIM      per capita crime rate by town</li>\n<li>ZN        proportion of residential land zoned for lots over<pre><code>     25,000 sq.ft.\n</code></pre>\n</li>\n<li>INDUS     proportion of non-retail business acres per town</li>\n<li>CHAS      Charles River dummy variable (= 1 if tract bounds<pre><code>     river; 0 otherwise)\n</code></pre>\n</li>\n<li>NOX       nitric oxides concentration (parts per 10 million)</li>\n<li>RM        average number of rooms per dwelling</li>\n<li>AGE       proportion of owner-occupied units built prior to 1940</li>\n<li>DIS       weighted distances to five Boston employment centres</li>\n<li>RAD       index of accessibility to radial highways</li>\n<li>TAX      full-value property-tax rate per $10,000</li>\n<li>PTRATIO  pupil-teacher ratio by town</li>\n<li>B        1000(Bk - 0.63)^2 where Bk is the proportion of blacks<pre><code>     by town\n</code></pre>\n</li>\n<li>LSTAT    % lower status of the population</li>\n<li>MEDV     Median value of owner-occupied homes in $1000's</li>\n</ol>\n</li>\n<li><p>Missing Attribute Values:  None.</p>\n</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1507704264770_189119664","id":"20171011-064424_759466760","dateCreated":"2017-10-11T06:44:24+0000","dateStarted":"2017-10-11T07:16:59+0000","dateFinished":"2017-10-11T07:17:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6173"},{"text":"%spark.pyspark\nfrom pyspark import SparkContext\n\ndata = sc.textFile(\"hdfs:///user/hadoop/housing.data\")\n\ndata2 = data.map(lambda x: [float(i) for i in x.strip().split()])\nspark.createDataFrame(data2, [\"CRIM\", \"ZN\", \"INDUS\", \"CHAS\", \"NOX\", \"RM\", \"AGE\", \"DIS\", \"RAD\", \"TAX\", \"PTRATIO\", \"B\", \"LSTAT\", \"MEDV\"]).show()","user":"anonymous","dateUpdated":"2017-10-11T07:17:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----+-----+----+-----+-----+-----+------+---+-----+-------+------+-----+----+\n|   CRIM|  ZN|INDUS|CHAS|  NOX|   RM|  AGE|   DIS|RAD|  TAX|PTRATIO|     B|LSTAT|MEDV|\n+-------+----+-----+----+-----+-----+-----+------+---+-----+-------+------+-----+----+\n|0.00632|18.0| 2.31| 0.0|0.538|6.575| 65.2|  4.09|1.0|296.0|   15.3| 396.9| 4.98|24.0|\n|0.02731| 0.0| 7.07| 0.0|0.469|6.421| 78.9|4.9671|2.0|242.0|   17.8| 396.9| 9.14|21.6|\n|0.02729| 0.0| 7.07| 0.0|0.469|7.185| 61.1|4.9671|2.0|242.0|   17.8|392.83| 4.03|34.7|\n|0.03237| 0.0| 2.18| 0.0|0.458|6.998| 45.8|6.0622|3.0|222.0|   18.7|394.63| 2.94|33.4|\n|0.06905| 0.0| 2.18| 0.0|0.458|7.147| 54.2|6.0622|3.0|222.0|   18.7| 396.9| 5.33|36.2|\n|0.02985| 0.0| 2.18| 0.0|0.458| 6.43| 58.7|6.0622|3.0|222.0|   18.7|394.12| 5.21|28.7|\n|0.08829|12.5| 7.87| 0.0|0.524|6.012| 66.6|5.5605|5.0|311.0|   15.2| 395.6|12.43|22.9|\n|0.14455|12.5| 7.87| 0.0|0.524|6.172| 96.1|5.9505|5.0|311.0|   15.2| 396.9|19.15|27.1|\n|0.21124|12.5| 7.87| 0.0|0.524|5.631|100.0|6.0821|5.0|311.0|   15.2|386.63|29.93|16.5|\n|0.17004|12.5| 7.87| 0.0|0.524|6.004| 85.9|6.5921|5.0|311.0|   15.2|386.71| 17.1|18.9|\n|0.22489|12.5| 7.87| 0.0|0.524|6.377| 94.3|6.3467|5.0|311.0|   15.2|392.52|20.45|15.0|\n|0.11747|12.5| 7.87| 0.0|0.524|6.009| 82.9|6.2267|5.0|311.0|   15.2| 396.9|13.27|18.9|\n|0.09378|12.5| 7.87| 0.0|0.524|5.889| 39.0|5.4509|5.0|311.0|   15.2| 390.5|15.71|21.7|\n|0.62976| 0.0| 8.14| 0.0|0.538|5.949| 61.8|4.7075|4.0|307.0|   21.0| 396.9| 8.26|20.4|\n|0.63796| 0.0| 8.14| 0.0|0.538|6.096| 84.5|4.4619|4.0|307.0|   21.0|380.02|10.26|18.2|\n|0.62739| 0.0| 8.14| 0.0|0.538|5.834| 56.5|4.4986|4.0|307.0|   21.0|395.62| 8.47|19.9|\n|1.05393| 0.0| 8.14| 0.0|0.538|5.935| 29.3|4.4986|4.0|307.0|   21.0|386.85| 6.58|23.1|\n| 0.7842| 0.0| 8.14| 0.0|0.538| 5.99| 81.7|4.2579|4.0|307.0|   21.0|386.75|14.67|17.5|\n|0.80271| 0.0| 8.14| 0.0|0.538|5.456| 36.6|3.7965|4.0|307.0|   21.0|288.99|11.69|20.2|\n| 0.7258| 0.0| 8.14| 0.0|0.538|5.727| 69.5|3.7965|4.0|307.0|   21.0|390.95|11.28|18.2|\n+-------+----+-----+----+-----+-----+-----+------+---+-----+-------+------+-----+----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1507700938728_665238311","id":"20171011-054858_1530906371","dateCreated":"2017-10-11T05:48:58+0000","dateStarted":"2017-10-11T07:17:14+0000","dateFinished":"2017-10-11T07:17:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6174"},{"text":"%spark.pyspark\n\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.mllib.regression import LabeledPoint\nfrom pyspark.ml.regression import LinearRegression\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder\nfrom pyspark.ml.feature import PolynomialExpansion\nfrom pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.ml import Pipeline\n\n# data3 = data2.map(lambda x: LabeledPoint(x[-1],x[0:len(x)-2])).toDF()\ndata3 = data2.map(lambda x: [x[-1],Vectors.dense(x[0:len(x)-2])])\ndata4 = spark.createDataFrame(data3, [\"label\", \"features\"])\ndata4.show(5, truncate=False)\n","user":"anonymous","dateUpdated":"2017-10-11T07:10:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------------------------------------------------------------------+\n|label|features                                                            |\n+-----+--------------------------------------------------------------------+\n|24.0 |[0.00632,18.0,2.31,0.0,0.538,6.575,65.2,4.09,1.0,296.0,15.3,396.9]  |\n|21.6 |[0.02731,0.0,7.07,0.0,0.469,6.421,78.9,4.9671,2.0,242.0,17.8,396.9] |\n|34.7 |[0.02729,0.0,7.07,0.0,0.469,7.185,61.1,4.9671,2.0,242.0,17.8,392.83]|\n|33.4 |[0.03237,0.0,2.18,0.0,0.458,6.998,45.8,6.0622,3.0,222.0,18.7,394.63]|\n|36.2 |[0.06905,0.0,2.18,0.0,0.458,7.147,54.2,6.0622,3.0,222.0,18.7,396.9] |\n+-----+--------------------------------------------------------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1507701155243_1220151850","id":"20171011-055235_727221645","dateCreated":"2017-10-11T05:52:35+0000","dateStarted":"2017-10-11T07:10:02+0000","dateFinished":"2017-10-11T07:10:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6175"},{"text":"%spark.pyspark\n\nassembler = VectorAssembler(inputCols=[\"features\"], outputCol=\"assembled\")\n\n# 交互作用項の追加\npe = PolynomialExpansion().setInputCol(\"features\").setOutputCol(\"polyfeatures\")\n\nregressor = LinearRegression().setStandardization(False).setSolver(\"l-bfgs\").setLabelCol(\"label\")\n\n# パラメータチューニングの設定\nparamGrid = (ParamGridBuilder()\n        .addGrid(pe.degree, [2,3])\n        .addGrid(regressor.maxIter, [10,25,50])\n        .addGrid(regressor.regParam, [0.0, 0.01, 0.1])\n        .addGrid(regressor.featuresCol, [\"features\", \"features\", \"polyFeatures\"])\n        .addGrid(regressor.featuresCol, [\"polyfeatures\"])\n        .build())\n\n# 評価にはRMSEを使う\nevaluator = RegressionEvaluator(metricName=\"rmse\")\n\n# 交差検定モデルの作成\nmodel = (CrossValidator()\n    .setEstimator(Pipeline(stages=[assembler, pe, regressor]))\n    .setEvaluator(evaluator)\n    .setEstimatorParamMaps(paramGrid)\n    .setNumFolds(5)\n    .fit(data4))\n\n\n\n\n    ","user":"anonymous","dateUpdated":"2017-10-11T07:58:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1507703209048_2083918817","id":"20171011-062649_1268527826","dateCreated":"2017-10-11T06:26:49+0000","dateStarted":"2017-10-11T07:58:04+0000","dateFinished":"2017-10-11T08:00:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6176"},{"text":"%spark.pyspark\n\nprint(\"best metrics is\",  min(model.avgMetrics))","user":"anonymous","dateUpdated":"2017-10-11T07:24:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"best metrics is 4.5443596397773\n"}]},"apps":[],"jobName":"paragraph_1507704455712_-162653557","id":"20171011-064735_1691745394","dateCreated":"2017-10-11T06:47:35+0000","dateStarted":"2017-10-11T07:24:30+0000","dateFinished":"2017-10-11T07:24:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6177"},{"text":"%spark.pyspark\nmodel.bestModel.transform(data4).show()","user":"anonymous","dateUpdated":"2017-10-11T07:32:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------------------+--------------------+--------------------+------------------+\n|label|            features|           assembled|        polyfeatures|        prediction|\n+-----+--------------------+--------------------+--------------------+------------------+\n| 24.0|[0.00632,18.0,2.3...|[0.00632,18.0,2.3...|[0.00632,3.99424E...| 25.86813228073403|\n| 21.6|[0.02731,0.0,7.07...|[0.02731,0.0,7.07...|[0.02731,7.458361...|24.282222519858333|\n| 34.7|[0.02729,0.0,7.07...|[0.02729,0.0,7.07...|[0.02729,7.447440...| 32.57933183456977|\n| 33.4|[0.03237,0.0,2.18...|[0.03237,0.0,2.18...|[0.03237,0.001047...| 31.70426384119063|\n| 36.2|[0.06905,0.0,2.18...|[0.06905,0.0,2.18...|[0.06905,0.004767...| 32.73288697359488|\n| 28.7|[0.02985,0.0,2.18...|[0.02985,0.0,2.18...|[0.02985,8.910225...| 26.08027158070393|\n| 22.9|[0.08829,12.5,7.8...|[0.08829,12.5,7.8...|[0.08829,0.007795...| 20.57022132072221|\n| 27.1|[0.14455,12.5,7.8...|[0.14455,12.5,7.8...|[0.14455,0.020894...|19.961291460003373|\n| 16.5|[0.21124,12.5,7.8...|[0.21124,12.5,7.8...|[0.21124,0.044622...|15.702740253359373|\n| 18.9|[0.17004,12.5,7.8...|[0.17004,12.5,7.8...|[0.17004,0.028913...|18.813120951399434|\n| 15.0|[0.22489,12.5,7.8...|[0.22489,12.5,7.8...|[0.22489,0.050575...|21.522339713954167|\n| 18.9|[0.11747,12.5,7.8...|[0.11747,12.5,7.8...|[0.11747,0.013799...| 19.16802960412294|\n| 21.7|[0.09378,12.5,7.8...|[0.09378,12.5,7.8...|[0.09378,0.008794...|21.108549586840883|\n| 20.4|[0.62976,0.0,8.14...|[0.62976,0.0,8.14...|[0.62976,0.396597...|17.475093351433742|\n| 18.2|[0.63796,0.0,8.14...|[0.63796,0.0,8.14...|[0.63796,0.406992...|16.776025755560724|\n| 19.9|[0.62739,0.0,8.14...|[0.62739,0.0,8.14...|[0.62739,0.393618...|17.479367371606294|\n| 23.1|[1.05393,0.0,8.14...|[1.05393,0.0,8.14...|[1.05393,1.110768...|19.442688502002216|\n| 17.5|[0.7842,0.0,8.14,...|[0.7842,0.0,8.14,...|[0.7842,0.6149696...| 16.49448059476009|\n| 20.2|[0.80271,0.0,8.14...|[0.80271,0.0,8.14...|[0.80271,0.644343...| 16.62312933432865|\n| 18.2|[0.7258,0.0,8.14,...|[0.7258,0.0,8.14,...|[0.7258,0.5267856...|16.722930177550488|\n+-----+--------------------+--------------------+--------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1507706450788_-1555590192","id":"20171011-072050_1650096358","dateCreated":"2017-10-11T07:20:50+0000","dateStarted":"2017-10-11T07:32:25+0000","dateFinished":"2017-10-11T07:32:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6178"},{"text":"%spark.pyspark\n\n\nmodel.bestModel.stages[2].coefficients","user":"anonymous","dateUpdated":"2017-10-11T07:40:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DenseVector([0.127, 0.0073, -0.0999, 0.0168, 0.0006, 0.3583, 0.0074, -0.0022, -0.0108, 8.5155, 3.0976, 0.1124, 0.5099, 8.5155, 26.9354, -0.7391, -0.0413, 0.1121, -49.471, -2.5645, 2.8357, -0.0121, 0.0041, 0.026, -0.963, -2.6271, 1.1642, 0.0965, -0.0019, -0.0015, 0.0016, 0.0141, -0.0926, -0.0074, -0.0001, -2.2715, -0.0732, -0.01, -0.1149, -1.6595, 0.5232, -0.0921, 0.0163, 0.1825, 0.5077, -0.0035, -0.0022, 0.0159, -0.3657, -0.4138, -0.1186, 0.0019, 0.0408, -0.0026, 0.0158, 0.0, 0.0003, 0.0007, 0.0102, -0.0129, -0.006, -0.0, -0.002, 0.0002, -0.0, 0.6151, 0.0039, 0.0059, -0.0251, 0.3029, -0.7246, -0.4493, -0.0032, 0.0576, 0.0197, 0.0006, 0.0417, -0.0037, -0.0006, -0.0001, 0.0004, 0.0163, -0.007, 0.0065, -0.0002, -0.0027, 0.0001, 0.0, 0.0002, -0.0])\n"}]},"apps":[],"jobName":"paragraph_1507706708823_-1469995859","id":"20171011-072508_194849863","dateCreated":"2017-10-11T07:25:08+0000","dateStarted":"2017-10-11T07:40:21+0000","dateFinished":"2017-10-11T07:40:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6179"},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2017-10-11T07:33:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1507707187918_-1261788696","id":"20171011-073307_921266878","dateCreated":"2017-10-11T07:33:07+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:6180"}],"name":"housing_demo","id":"2CUWSXJGD","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}